/* MeowMap Theme Tokens and Themes */

/* Font declarations */
@font-face {
  font-family: 'NTSomic';
  src: url('../fonts/Fonts/TTF/NTSomic-Regular.ttf') format('truetype');
  font-weight: 400;
  font-style: normal;
}
@font-face {
  font-family: 'NTSomic';
  src: url('../fonts/Fonts/TTF/NTSomic-Medium.ttf') format('truetype');
  font-weight: 500;
  font-style: normal;
}
@font-face {
  font-family: 'NTSomic';
  src: url('../fonts/Fonts/TTF/NTSomic-Bold.ttf') format('truetype');
  font-weight: 700;
  font-style: normal;
}

/* 1) Base tokens */
:root{
  --surface-0:#fff;        /* page background */
  --surface-1:#f7f7f9;     /* panels/cards */
  --surface-2:#eceef1;     /* hover/bg subtle */
  --text-0:#0f1222;        /* primary text */
  --text-1:#5c6370;        /* secondary */
  --text-2:#d1d5db;        /* tertiary */
  --brand:#2f7ef7;         /* brand/primary */
  --accent:#22b07d;        /* secondary accent */
  --danger:#e0565b; --warn:#f2b01d; --ok:#2db84d;
  --border:1px solid color-mix(in srgb, var(--text-1) 15%, transparent);
  --radius-xs:6px; --radius-sm:10px; --radius-md:16px; --radius-lg:22px;
  --shadow-sm:0 1px 2px rgba(0,0,0,.06);
  --shadow-md:0 6px 24px rgba(0,0,0,.10);
  --fx-fast:.15s; --fx-slow:.28s;
  --font-ui: 'NTSomic', Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  --font-mono: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  --date-icon-filter:none; /* фильтр для иконки календаря */
}

/* 2) Baseline, buttons and focus rings (tokenized) */
html,body{height:100%;}
body{
  background:var(--surface-0); color:var(--text-0);
  font-family:var(--font-ui);
  transition: background var(--fx-slow), color var(--fx-slow);
}

.btn{
  display:inline-flex; align-items:center; gap:.5rem; padding:.5rem .9rem;
  border:var(--border); border-radius:var(--radius-sm);
  background:var(--surface-1); color:var(--text-0);
  cursor:pointer; user-select:none;
}
.btn-primary{ background:var(--brand); border-color:transparent; color:#fff; }
.btn-ghost{ background:transparent; border-color:transparent; }
.btn:hover{ filter:brightness(0.98); }
.btn:active{ transform:translateY(1px); }
.btn:focus-visible{ outline:3px solid color-mix(in srgb, var(--brand) 55%, transparent); outline-offset:2px; }

button, [role="button"], a, input, select, textarea{
  outline: none;
}
button:focus-visible, [role="button"]:focus-visible, a:focus-visible, input:focus-visible, select:focus-visible, textarea:focus-visible{
  outline:3px solid color-mix(in srgb, var(--brand) 55%, transparent);
  outline-offset:2px;
}

/* Поля ввода даты — стили зависят от темы */
input[type="date"]{
  background:#d2cde7;
  color:var(--text-0);
  border:none;
  border-radius:9999px;
  padding:.5rem .75rem;
  accent-color: var(--brand);
  color-scheme: light; /* светлый календарь по умолчанию */
  font-family:var(--font-ui);
  font-size:16px;
  cursor:pointer;
  transition: all var(--fx-fast);
  box-shadow: var(--shadow-sm);
  min-height:20px;
  min-width:160px;
  /* Полностью отключаем системный календарь браузера */
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
}
input[type="date"]:hover{
  background: color-mix(in srgb, #d2cde7 90%, transparent);
}
input[type="date"]:focus{
  outline:3px solid color-mix(in srgb, var(--brand) 55%, transparent);
  outline-offset:2px;
  background: color-mix(in srgb, #d2cde7 90%, transparent);
}
input[type="date"]::-webkit-calendar-picker-indicator{
  display: none;
  opacity: 0;
  cursor: default;
}
input[type="date"]::-moz-focus-inner {
  border: 0;
  padding: 0;
}
/* Тёмные темы: тёмный системный календарь */
html[data-theme="neon"] input[type="date"],
html[data-theme="amoled"] input[type="date"]{
  color-scheme: dark;
}

/* 3) MapLibre UI (controls + popups) */
.maplibregl-ctrl-group{
  border-radius:var(--radius-sm);
  overflow:hidden;
  box-shadow:var(--shadow-sm);
}
.maplibregl-ctrl button{
  background:var(--surface-1); color:var(--text-0); border:var(--border);
  width:38px; height:38px; line-height:38px; text-align:center;
}
.maplibregl-ctrl button:hover{ filter:brightness(0.96); }
.maplibregl-ctrl button:focus-visible{ outline:3px solid color-mix(in srgb, var(--brand) 55%, transparent); outline-offset:2px; }
.maplibregl-ctrl button:active{ transform:translateY(1px); }
.maplibregl-popup-content{
  background:var(--surface-1); color:var(--text-0);
  border-radius:var(--radius-md); box-shadow:var(--shadow-md); border:var(--border);
  font-family:var(--font-ui);
}
.maplibregl-popup-tip{
  border-top-color:transparent !important;
  border-bottom-color:transparent !important;
  border-left-color:transparent !important;
  border-right-color:transparent !important;
}
.maplibregl-popup-anchor-bottom .maplibregl-popup-tip,
.maplibregl-popup-anchor-bottom-left .maplibregl-popup-tip,
.maplibregl-popup-anchor-bottom-right .maplibregl-popup-tip{
  border-top-color:var(--surface-1) !important;
  margin-top:-1px;
}
.maplibregl-popup-anchor-top .maplibregl-popup-tip,
.maplibregl-popup-anchor-top-left .maplibregl-popup-tip,
.maplibregl-popup-anchor-top-right .maplibregl-popup-tip{
  border-bottom-color:var(--surface-1) !important;
  margin-bottom:-1px;
}
.maplibregl-popup-anchor-left .maplibregl-popup-tip{
  border-right-color:var(--surface-1) !important;
  margin-left:-1px;
}
.maplibregl-popup-anchor-right .maplibregl-popup-tip{
  border-left-color:var(--surface-1) !important;
  margin-right:-1px;
}
.popup-text-handle {
  width: 38px;
  height: 5px;
  border-radius: 999px;
  background: color-mix(in srgb, var(--text-1) 25%, transparent);
  margin: 10px auto 0 auto;
  cursor: pointer;
  transition: background 0.15s;
  box-shadow: 0 1px 4px rgba(0,0,0,0.08);
}
.popup-text-handle:hover {
  background: var(--brand);
}
.popup-text-full {
  max-height: 160px;
  overflow: auto;
  word-break: break-word;
  overflow-wrap: break-word;
  word-wrap: break-word; /* fallback for old browsers */
}
.popup-text {
  word-break: break-word;
  overflow-wrap: break-word;
  word-wrap: break-word; /* fallback for old browsers */
}

/* 4) Scrollbar (webkit) */
*::-webkit-scrollbar{ width:10px; height:10px; }
*::-webkit-scrollbar-track{ background:var(--surface-2); }
*::-webkit-scrollbar-thumb{ background:color-mix(in srgb, var(--brand) 35%, transparent); border-radius:10px; }

/* 5) Themes */
/* A) Minimal / Моно-минимал */
html[data-theme="minimal"]{
  --surface-0:#ffffff; --surface-1:#d2cde77e; --surface-2:#eef1f5;
  --text-0:#2B2A29; --text-1:#6B7280; --text-2:#D1D5DB;
  --brand:#2f7ef7; --accent:#22b07d;
  --radius-sm:8px; --radius-md:12px;
  --shadow-md: 0 0 16px #22d3ee, 0 0 32px #f472b6;
}

/* B) Neon Pulse / Молодёжный неон (glass) */
html[data-theme="neon"]{
  --surface-0:#0a0b0f; --surface-1:rgba(18,20,28,.68); --surface-2:rgba(36,40,58,.6);
  --text-0:#e9ecff; --text-1:#aab1c9;
  --brand:#22d3ee; --accent:#f472b6; /* cyan + pink */
  --border:1px solid rgba(255,255,255,.08);
  --shadow-md:0 20px 50px rgba(0,0,0,.45); --radius-md:16px;
  backdrop-filter: blur(10px);
}
html[data-theme="neon"]{ --date-icon-filter: invert(1) brightness(1.1); }
/* neon extras */
html[data-theme="neon"] .btn-primary{
  background:linear-gradient(135deg,var(--brand),var(--accent));
  border-color:transparent;
  box-shadow:0 0 0 1px rgba(255,255,255,.08) inset, 0 10px 30px rgba(0,0,0,.45);
}
/* neon popup buttons */
html[data-theme="neon"] button.expand-btn,
html[data-theme="neon"] button.share-btn {
  background: #2B2A29 !important;
  color: var(--text-0) !important;
}
html[data-theme="neon"] button.expand-btn:hover,
html[data-theme="neon"] button.share-btn:hover {
  background: color-mix(in srgb, #2B2A29 85%, #0a0b0f) !important;
}

/* minimal popup buttons */
html[data-theme="minimal"] button.expand-btn,
html[data-theme="minimal"] button.share-btn {
  color: var(--text-0) !important;
}
html[data-theme="minimal"] button.expand-btn:hover,
html[data-theme="minimal"] button.share-btn:hover {
  background: color-mix(in srgb, #d2cde7 85%, white) !important;
}

/* Calendar styles for neon theme */
html[data-theme="neon"] input[type="date"] {
  background: #2B2A29;
}

html[data-theme="neon"] .calendar__day {
  background: #2B2A29;
}

html[data-theme="neon"] .calendar__day--other-month {
  background: color-mix(in srgb, #2B2A29 50%, transparent);
}


/* Стилей для неактуальных тем не осталось */

/* Непрозрачный футер сайдбара для тем minimal и neon */
html[data-theme="minimal"] .sidebar-footer {
  background: #f9c5ff; /* Непрозрачный вариант surface-1 для minimal */
}
html[data-theme="neon"] .sidebar-footer {
  background: rgba(18,20,28,1); /* Непрозрачный вариант surface-1 для neon */
}

/* 6) Calendar Dropdown */
.calendar-modal {
  position: absolute;
  top: 100%;
  left: 0;
  z-index: 2000;
  animation: calendar-fade-in var(--fx-fast) ease-out;
  margin-top: 16px;
  transform-origin: top left;
}

.calendar-modal[hidden] {
  display: none;
}

.calendar-modal__backdrop {
  display: none;
}

.calendar-modal__content {
  position: relative;
  background: var(--surface-1);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-md);
  border: var(--border);
  width: min(320px, 90vw);
  max-height: min(400px, 70vh);
  overflow: hidden;
  animation: calendar-slide-in var(--fx-slow) ease-out;
}

.calendar {
  padding: 16px 20px 20px;
}

.calendar__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 16px;
}

.calendar__nav {
  background: none;
  border: none;
  font-size: 18px;
  color: var(--text-1);
  cursor: pointer;
  padding: 6px;
  border-radius: var(--radius-xs);
  transition: all var(--fx-fast);
  min-height: 32px;
  min-width: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.calendar__nav:hover {
  background: var(--surface-2);
  color: var(--text-0);
}

.calendar__nav:focus-visible {
  outline: 3px solid color-mix(in srgb, var(--brand) 55%, transparent);
  outline-offset: 2px;
}

.calendar__month-year {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--text-0);
  text-align: center;
  flex: 1;
}

.calendar__weekdays {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 4px;
  margin-bottom: 12px;
}

.calendar__weekday {
  text-align: center;
  font-size: 0.85rem;
  font-weight: 500;
  color: var(--text-1);
  padding: 8px 4px;
}

.calendar__days {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 4px;
}

.calendar__day {
  aspect-ratio: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #D2CDE7;
  border: none;
  border-radius: 50%;
  font-size: 0.9rem;
  color: var(--text-0);
  cursor: pointer;
  transition: all var(--fx-fast);
  position: relative;
}

.calendar__day:hover {
  background: var(--surface-2);
}

.calendar__day:focus-visible {
  outline: 3px solid color-mix(in srgb, var(--brand) 55%, transparent);
  outline-offset: 2px;
}

.calendar__day--current {
  background: var(--brand);
  color: white;
  font-weight: 600;
}

.calendar__day--current:hover {
  background: color-mix(in srgb, var(--brand) 90%, black);
}

.calendar__day--other-month {
  background: color-mix(in srgb, #D2CDE7 50%, transparent);
  color: #a2a2a2;
  opacity: 1;
}

.calendar__day--selected {
  position: relative;
  border: 2px solid #2B2A29 !important;
}

.calendar__day--today {
  position: relative;
  background: var(--surface-2);
  border: none;
}

.calendar__day--disabled {
  cursor: not-allowed;
  opacity: 0.3;
}

.calendar__day--disabled:hover {
  background: transparent;
}

/* Анимации календаря */
@keyframes calendar-fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes calendar-slide-in {
  from {
    opacity: 0;
    transform: scale(0.9) translateY(20px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

/* Мобильная адаптация календаря */
@media (max-width: 480px) {
  .calendar-modal__content {
    width: 95vw;
    max-height: 75vh;
  }

  .calendar {
    padding: 12px 16px 16px;
  }

  .calendar__header {
    margin-bottom: 12px;
  }

  .calendar__nav {
    font-size: 16px;
    padding: 4px;
  }

  .calendar__month-year {
    font-size: 1rem;
  }

@media (max-width: 375px) {
  .calendar-modal__content {
    width: 98vw;
    max-height: 70vh;
  }

   .calendar {
    padding: 10px 12px 14px;
  }

  .calendar__header {
    margin-bottom: 10px;
  }

  .calendar__nav {
    font-size: 14px;
    padding: 3px;
  }

  .calendar__month-year {
    font-size: 0.9rem;
  }

  .calendar__weekdays {
    margin-bottom: 8px;
  }

  .calendar__weekday {
    padding: 4px 2px;
  }

  .calendar__day {
    aspect-ratio: 0.9;
  }
}

@media (max-width: 320px) {
  .calendar-modal__content {
    width: 100vw;
    max-height: 65vh;
  }

  .calendar {
    padding: 8px 10px 12px;
  }

  .calendar__header {
    margin-bottom: 8px;
  }

  .calendar__nav {
    font-size: 12px;
    padding: 2px;
  }

  .calendar__month-year {
    font-size: 0.8rem;
  }

  .calendar__weekdays {
    margin-bottom: 6px;
  }

  .calendar__weekday {
    padding: 3px 1px;
    font-size: 0.75rem;
  }

  .calendar__day {
    aspect-ratio: 0.85;
  }
}
html[data-theme="neon"] .sidebar-footer {
  background: rgba(18,20,28,1); /* Непрозрачный вариант surface-1 для neon */
}
html[data-theme="neon"] .btn {
  background: rgba(18,20,28,1);
}
